<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Músicas - Brother Who</title>
  <link rel="stylesheet" href="../CSS/estilo.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>
  <header class="cabecalho">
    <div class="logo">
      <img src="../CAPAS/Logo B-who (1).png" alt="Logo Brother Who" />
      <a href="../index.html" class="nome-banda" style="text-decoration: none; color: inherit;">
        <h1>Brother Who</h1>
        <p>Rock & Metal | São Paulo</p>
      </a>
    </div>
    <nav class="menu">
      <a href="agenda.html"><i class="ph-calendar"></i> Agenda</a>
      <a href="musicas.html"><i class="ph-music-note"></i> Músicas</a>
      <a href="contato.html"><i class="ph-users"></i> Contato</a>
    </nav>
    <div class="botao-show">
      <a href="../pages/contratar.html"><button>Contratar Show</button></a>
    </div>
  </header>

  <main>
    <section>
      <h1 style="text-align:center; margin-top: 30px;">Próximo Lançamento</h1>
      <div id="musica-destaque" class="musica-destaque">
        <!-- Música destaque vai aparecer aqui -->
      </div>
    </section>

    <section class="lista-musicas">
      <h2 style="color: white; text-align:center; margin-bottom: 20px;">Lista de Músicas</h2>
      <div id="lista-musicas"></div>
    </section>
  </main>

  <script>
    fetch("https://opensheet.elk.sh/1SeaT_oYgJwLiR7Q-zQuBcJ75Q5QtZhhMgf37qwIbmrk/Página2")
      .then(res => res.json())
      .then(data => {
        const destaque = document.getElementById("musica-destaque");
        const lista = document.getElementById("lista-musicas");

        // Encontrar o próximo lançamento
        const proximoLancamento = data.find(musica => 
          musica.Status && musica.Status.trim().toLowerCase() === "próximo lançamento"
        );

        if (proximoLancamento) {
          destaque.innerHTML = `
            <img src="${proximoLancamento["Local Foto Capa"]}" alt="Capa da música ${proximoLancamento["Nome da Musica"]}" />
            <h3>${proximoLancamento["Nome da Musica"]}</h3>
            <p><em>Álbum: ${proximoLancamento.Album}</em></p>
            <p><strong>Data de lançamento:</strong> ${proximoLancamento["Data do Lançameto"]}</p>
          `;
        } else {
          destaque.innerHTML = "<p>Nenhum próximo lançamento encontrado.</p>";
        }

        // Músicas lançadas agrupadas por álbum
        const musicasLancadas = data.filter(m => m.Status?.trim().toLowerCase() === "lançada");

        const albuns = {};
        musicasLancadas.forEach(musica => {
          const album = musica.Album || "Sem Álbum";
          if (!albuns[album]) albuns[album] = [];
          albuns[album].push(musica);
        });

        Object.keys(albuns).forEach(nomeAlbum => {
          const blocoAlbum = document.createElement("div");
          blocoAlbum.className = "bloco-album";

          const tituloAlbum = document.createElement("h3");
          tituloAlbum.textContent = `Álbum: ${nomeAlbum}`;
          tituloAlbum.className = "titulo-album";
          blocoAlbum.appendChild(tituloAlbum);

          albuns[nomeAlbum].forEach(musica => {
            const item = document.createElement("div");
            item.className = "musica-item";
            item.innerHTML = `
              <img src="${musica["Local Foto Capa"]}" alt="Capa da música ${musica["Nome da Musica"]}" />
              <div class="musica-info">
                <strong>${musica["Nome da Musica"]}</strong>
              </div>
              <a href="${musica['Link do Spotify']}" target="_blank" class="botao-play" aria-label="Ouvir no Spotify">
                <i class="fab fa-spotify"></i>
              </a>
            `;
            blocoAlbum.appendChild(item);
          });

          lista.appendChild(blocoAlbum);
        });
      })
      .catch(err => {
        console.error("Erro ao carregar músicas:", err);
        document.getElementById("musica-destaque").innerHTML = "<p>Erro ao carregar músicas. Tente mais tarde.</p>";
      });
  </script>

  <footer class="rodape">
    <div class="rodape-conteudo">
      <p>&copy; 2025 Brother Who. Todos os direitos reservados.</p>
      <p>São Paulo - SP | Contato: bandabrotherwho@gmail.com</p>
    </div>
  </footer>
</body>
</html>
